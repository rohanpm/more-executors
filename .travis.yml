sudo: false
language: python
install: pip install tox
branches:
  only:
    # This is where pull requests from "bors r+" are built.
    - staging
    # This is where pull requests from "bors try" are built.
    - trying
    # This is where changes end up
    - master
matrix:
  include:
  # Each python version is repeated multiple times here to make flaky
  # tests less likely to get past Travis by running them more times
  - python: "2.6"
    env: TOX_ENV=py26 ITER=1
  - python: "2.6"
    env: TOX_ENV=py26 ITER=2
  - python: "2.6"
    env: TOX_ENV=py26 ITER=3
  - python: "2.7"
    env: TOX_ENV=py27 ITER=1
  - python: "2.7"
    env: TOX_ENV=py27 ITER=2
  - python: "2.7"
    env: TOX_ENV=py27 ITER=3
  - python: "3.5"
    env: TOX_ENV=py35 ITER=1
  - python: "3.5"
    env: TOX_ENV=py35 ITER=2
  - python: "3.5"
    env: TOX_ENV=cov-travis
  - python: "3.5"
    env: TOX_ENV=static
  - python: "3.5"
    env: TOX_ENV=docs
script: tox -e $TOX_ENV -- -s -o log_cli=true -o log_cli_level=DEBUG
after_success:
- test $TOX_ENV = docs && scripts/push-docs
